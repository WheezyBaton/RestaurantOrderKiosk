<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Panel Admina</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
    <body class="bg-light">
        <nav class="navbar navbar-dark bg-dark mb-4">
            <div class="container">
                <span class="navbar-brand mb-0 h1">üõ†Ô∏è Kiosk Manager</span>
                <form th:action="@{/logout}" method="post">
                    <button class="btn btn-outline-light btn-sm">Wyloguj</button>
                </form>
            </div>
        </nav>
        <div class="container mb-5">
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card text-white bg-success mb-3 shadow">
                        <div class="card-header">Dzisiejszy Przych√≥d (Ca≈Çkowity)</div>
                        <div class="card-body">
                            <h1 class="card-title display-4"
                                th:text="${#numbers.formatDecimal(totalRevenue, 1, 'COMMA', 2, 'POINT')} + ' PLN'">
                                0.00 PLN
                            </h1>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card text-white bg-primary mb-3 shadow">
                        <div class="card-header">Liczba Zam√≥wie≈Ñ (Dzi≈õ)</div>
                        <div class="card-body">
                            <h1 class="card-title display-4" th:text="${todayOrders}">0</h1>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card shadow border-0">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h4 class="mb-0 text-muted">üìä Raport Sprzeda≈ºy Produkt√≥w (Bestsellery)</h4>
                    <a th:href="@{/admin/report/export}" class="btn btn-primary btn-sm">
                        ‚¨áÔ∏è Pobierz CSV
                    </a>
                </div>
                <div class="card-body p-0">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                        <tr>
                            <th>Nazwa Produktu</th>
                            <th>Sprzedana Ilo≈õƒá</th>
                            <th>Przych√≥d z produktu</th>
                            <th style="width: 40%">Wykres</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="stat : ${salesStats}">
                            <td class="fw-bold" th:text="${stat.productName}">Burger</td>
                            <td th:text="${stat.totalQuantity} + ' szt.'">10 szt.</td>
                            <td class="text-success fw-bold" th:text="${stat.totalRevenue} + ' PLN'">500.00 PLN</td>
                            <td>
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-info" role="progressbar"
                                         th:style="'width: ' + (${stat.totalQuantity} * 5) + '%'"
                                         th:text="${stat.totalQuantity}"></div>
                                </div>
                            </td>
                        </tr>
                        <tr th:if="${salesStats.isEmpty()}">
                            <td colspan="4" class="text-center text-muted py-3">Brak danych sprzeda≈ºowych. Z≈Ç√≥≈º pierwsze zam√≥wienie!</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <hr class="my-5">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Produkty</h2>
                <a th:href="@{/admin/products/add}" class="btn btn-success">+ Nowy Produkt</a>
            </div>
            <div class="card shadow-sm">
                <div class="card-body p-0">
                    <table class="table table-striped table-hover mb-0">
                        <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Zdjƒôcie</th>
                            <th>Nazwa</th>
                            <th>Kategoria</th>
                            <th>Cena</th>
                            <th>Akcje</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="p : ${products}">
                            <td th:text="${p.id}">1</td>
                            <td>
                                <img th:if="${p.imageUrl != null and !p.imageUrl.startsWith('http')}"
                                     th:src="@{'/images/uploads/' + ${p.imageUrl}}" width="50" height="50" class="object-fit-cover rounded">

                                <img th:if="${p.imageUrl != null and p.imageUrl.startsWith('http')}"
                                     th:src="${p.imageUrl}" width="50" height="50" class="object-fit-cover rounded">
                            </td>
                            <td th:text="${p.name}">Burger</td>
                            <td th:text="${p.category?.name}">Kategoria</td>
                            <td th:text="${p.basePrice} + ' PLN'">20.00</td>
                            <td>
                                <a th:href="@{'/admin/products/delete/' + ${p.id}}"
                                   class="btn btn-sm btn-danger"
                                   onclick="return confirm('Czy na pewno usunƒÖƒá?')">Usu≈Ñ</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>
</html>